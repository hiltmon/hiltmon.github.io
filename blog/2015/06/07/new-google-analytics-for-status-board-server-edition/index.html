<!doctype html><html><head>
<link rel=stylesheet href=/css/main.css>
<link rel=stylesheet href=/css/all.css>
<link rel=stylesheet href=/css/fusion.css>
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,400italic,700italic" rel=stylesheet type=text/css>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
<title>New Google Analytics for Status Board Server Edition</title>
</head>
<body>
<div id=container><header id=header>
<img id=logo src=/images/hiltmon-logo-174.png>
<h1 id=title><a href=/>Hiltmon</a></h1>
<h2 id=sub-title>On walkabout in life and technology</h2>
</header>
<nav id=menu>
<ul>
<li>
<a href=/about/ title="about me">About</a>
</li>
<li>
<a href=/code/ title=code>Code</a>
</li>
<li>
<a href=/products/ title=products>Products</a>
</li>
<li>
<a href=/ title="blog section">Blog</a>
</li>
<li>
<a href=/archives/ title="archives section">Archives</a>
</li>
</ul>
</nav>
<section id=content>
<p class=meta-data>
<span class=post-date>Jun 7, 2015 7:47 PM</span>
</p>
<h1 class=post-title>
New Google Analytics for Status Board Server Edition
</h1>
<div class=post-body>
<p>Last week, Google finally deprecated their non-Oauth APIs, which means that the <a href=https://hiltmon.com/blog/categories/status-board/>Google Analytics for Status Board</a> code I have been publishing stopped working. Fortunately for us, Github user <a href=https://github.com/erebusnz/gapi-google-analytics-php-interface>erebusnz</a> updated the PHP API to work with OAuth2 and we can access Google again. I have included it in a new version of the Server Edition Package.</p>
<h2 id=quick-install-instructions>Quick Install Instructions</h2>
<ol>
<li>Download the <a href=https://hiltmon.com/files/statusboard.zip>statusboard.zip</a> file.</li>
<li>Expand it in the root of your web server. It creates a <code>statusboard</code> folder.</li>
<li><strong>New:</strong> Register your application with Google Developers Console and get your Service Account email and P12 certificate file.</li>
<li><strong>New:</strong> Determine your profile ID (its the number after the &lsquo;p&rsquo; in the URL generated for your analytics)</li>
<li>**New:**Replace the 3 instances of &lt;&mdash;-> in <em>each</em> PHP file with your service account, P12 file name and profile ID.</li>
<li>The URL to use in Status Board is <code>http://&lt;your-domain>/statusboard/analytics_&lt;file>.php</code>, replacing <code>&lt;your-domain></code> with your server domain name, and <code>&lt;file></code> with one of <code>views</code> (graph), <code>hourly</code> (graph) or <code>pages</code> (table).</li>
</ol>
<p>You should get something like this <span class=light>(Yes, my follower count is still tiny. Yes, I live in New York, but I still use Celsius for weather. And awesome Inbox Zero!)</span>:</p>
<figure><img src=images/status-board-000.png width=715 height=537>
</figure>
<h2 id=details>Details</h2>
<p>There are four files in the archive:</p>
<ul>
<li><code>analytics_views.php</code> to present a graph of Page views, Visitors and New Visits for the past week for a site.</li>
<li><code>analytics_hourly.php</code> to present the same data over the last 24 hours.</li>
<li><code>analytics_pages.php</code> to show the top pages today.</li>
<li><code>gapi.class.php</code> is required to access Google Analytics</li>
</ul>
<h3 id=registering-your-api-access>Registering your API Access</h3>
<p>You need to create a new Project in the <a href=https://console.developers.google.com/project>Google Developers Console</a> in order to permit your web application to access Google&rsquo;s data.</p>
<figure><img src=images/status-board-001.png width=529 height=191>
</figure>
<ol>
<li>Click <strong>Create Project</strong></li>
</ol>
<figure><img src=images/status-board-002.png width=532 height=241>
</figure>
<ol start=2>
<li>Give the Project a Name, such as &ldquo;My-GAPI-Project&rdquo;</li>
<li>Wait while Google does its thing and moves you to the Project Dashboard</li>
<li>Click on &ldquo;APIs & Auth&rdquo;</li>
<li>Click &ldquo;APIs&rdquo; and search for &ldquo;Analytics&rdquo;</li>
</ol>
<figure><img src=images/status-board-003.png width=529 height=196>
</figure>
<ol start=6>
<li>Click on &ldquo;Analytics API&rdquo; then click &ldquo;Enable API&rdquo;</li>
</ol>
<figure><img src=images/status-board-004.png width=505 height=195>
</figure>
<ol start=7>
<li>Click on &ldquo;Credentials&rdquo; to create a service account</li>
</ol>
<figure><img src=images/status-board-005.png width=537 height=197>
</figure>
<ol start=8>
<li>Click on &ldquo;Create new Client ID&rdquo;</li>
<li>Choose &ldquo;Service account&rdquo; and click &ldquo;Create Client ID&rdquo;</li>
<li>Wait for it&mldr;</li>
<li>Google will download a JSON file to you. So nice of them.</li>
<li>Click &ldquo;OK, got it&rdquo;</li>
</ol>
<h3 id=fill-in-the-details>Fill in the Details</h3>
<p>You will now create, copy and paste the three elements needed for the Analytics PHP files to access Googles Analytics API.</p>
<figure><img src=images/status-board-006.png width=638 height=138>
</figure>
<ol>
<li>Copy the &ldquo;Email address&rdquo; which ends with &ldquo;@developer.gserviceaccount.com&rdquo; and replace the &ldquo;&lt;Email address @developer.gserviceaccount.com>&rdquo; in each analytics PHP file.</li>
<li>Click &ldquo;Generate new P12 Key&rdquo;. Google will send you a &ldquo;.p12&rdquo; file.</li>
<li>Copy this file into the SAME folder as the analytics PHP files.</li>
<li>Replace the &ldquo;&lt;P-File Name.p12>&rdquo; in each Analytics PHP file with the execat name of the P12 file (including extension, no path needed)</li>
<li>Go to <a href=http://www.google.com/analytics/>Google Analytics</a> and bring up one of the reports for the site you want to track.</li>
<li>Copy and paste the URL into a text editor, we&rsquo;re going spelunking for the profile ID. E.g. httpz://www.google.com/analytics/web/?hl=en#realtime/rt-overview/a1234567w1234567p9999999/"</li>
<li>Your profile ID is the set of digits after the &lsquo;p&rsquo; at the end of the URL (in this case a fake 9999999). Paste that into the &ldquo;&lt;Use Yours>&rdquo; in each analytics PHP file.</li>
</ol>
<p>The top of each file should look something like this (codes are fake):</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback>define(&#39;ga_profile_id&#39;,&#39;9999999&#39;);

require &#39;gapi.class.php&#39;;

date_default_timezone_set(&#39;America/New_York&#39;);

$ga = new gapi(&#39;729847129341293-938825he75l8mdabcxsh72hdqkdmpfobq273@developer.gserviceaccount.com&#39;, 
  &#39;My-GAPI-Project-384idsucy44f.p12&#39;);
</code></pre></div><h3 id=accessing-from-status-board>Accessing from Status Board</h3>
<p>For the &lsquo;hourly&rsquo; &ldquo;and &lsquo;views&rsquo; graphs, create a new Status Board chart panel and set the URL to &ldquo;&lt;your domain>/status_board/analytics_hourly.php&rdquo; and &ldquo;&lt;your domain>/status_board/analytics_views.php&rdquo; respectively. For the Top pages list, create a new Status Board table and set the URL to &ldquo;&lt;your domain>/status_board/analytics_pages.php&rdquo;.</p>
<p>Enjoy.</p>
<p><em>Follow the author as <a href=https://twitter.com/hiltmon>@hiltmon</a> on Twitter.</em></p>
</div>
<p class=post-mark>
<span class="fas fa-envelope"></span>
<span>Posted By Hilton Lipschitz</span>
&#183;
<span class="fas fa-clock"></span>
<span>Jun 7, 2015 7:47 PM</span>
</p>
<div class=pagination>
<ul>
<li class=post-previous><a href=https://hiltmon.github.io/blog/2015/06/27/a-simple-markdown-spotlight-importer/>&larr; A simple Markdown Spotlight importer</a></li>
<li class=post-center>&nbsp;</li>
<li class=post-next><a href=https://hiltmon.github.io/blog/2015/05/29/that-last-effin-20-percent/>That last effin 20% &rarr;</a></li>
</ul>
</div>
</section><aside id=sidebar>
<section>
<h1>The Hiltmon Dot Com</h1>
<p><strong>Hilton Lipschitz</strong> (<a href=https://twitter.com/hiltmon>@hiltmon</a>) is CTO of an up and coming Hedge Fund, who loves to craft brilliant and delightful web, iPhone, iPad and Macintosh software products. Before this he was an independent software consultant, designer and developer at <a href=http://www.noverse.com>Noverse LLC</a>.</p>
</section><section>
<h1>Recent Posts</h1>
<ul>
<li><a class=sidebar-link href=https://hiltmon.github.io/blog/2020/06/07/working-from-home-88-days-later/>Working from Home ... 88 Days Later</a></li>
<li><a class=sidebar-link href=https://hiltmon.github.io/blog/2020/03/14/working-from-home-dot-dot-dot-here-we-go/>Working from Home ... here we go!</a></li>
<li><a class=sidebar-link href=https://hiltmon.github.io/blog/2019/12/31/the-theater-was-empty/>The Theater was Empty</a></li>
<li><a class=sidebar-link href=https://hiltmon.github.io/blog/2019/02/16/an-ipad-and-a-pencil/>An iPad and a Pencil</a></li>
<li><a class=sidebar-link href=https://hiltmon.github.io/blog/2019/02/09/testing-c-plus-plus-17-project-in-xcode-with-xctest/>Testing C++17 Projects in Xcode with XCTest</a></li>
<li><a class=sidebar-link href=https://hiltmon.github.io/blog/2018/06/17/on-removing-comments/>On Removing Comments</a></li>
<li><a class=sidebar-link href=https://hiltmon.github.io/blog/2018/06/17/stop-and-think/>Stop and Think</a></li>
<li><a class=sidebar-link href=https://hiltmon.github.io/blog/2017/08/31/migrate-octopress-slash-jekyll-posts-to-ulysses/>Migrate Octopress / Jekyll Posts to Ulysses</a></li>
<li><a class=sidebar-link href=https://hiltmon.github.io/blog/2017/03/12/notification-city/>Notification City</a></li>
<li><a class=sidebar-link href=https://hiltmon.github.io/blog/2017/03/05/coding-style-standards-in-2017/>Coding Style Standards in 2017</a></li>
</ul>
<section></aside><footer id=footer>
<p>Copyright &copy; 2022 Hilton Lipschitz</p>
</footer></div>
</body>
</html>