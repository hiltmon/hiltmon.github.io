<!doctype html><html><head><meta charset=utf-8><meta name=keywords content><meta name=description content><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZFJ7SZKLR0"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZFJ7SZKLR0",{anonymize_ip:!1})}</script><meta name=robots content="index,follow"><link rel=stylesheet href=https://hiltmon.com/css/main.css><link rel=stylesheet href=https://hiltmon.com/css/all.css><link rel=stylesheet href=https://hiltmon.com/css/carbon.css><link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,400italic,700italic' rel=stylesheet type=text/css><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script><title>Simple C++: From Makefiles to Xcode Builds</title></head><body><div id=container><header id=header><img id=logo src=https://hiltmon.com/images/hiltmon-logo-174.png><h1 id=title><a href=https://hiltmon.com/>Hiltmon</a></h1><h2 id=sub-title>On walkabout in life and technology</h2></header><nav id=menu><ul><li><a href=https://hiltmon.com/about/ title="about me">About</a></li><li><a href=https://hiltmon.com/ title="blog section">Blog</a></li><li><a href=https://hiltmon.com/code/ title=code>Code</a></li><li><a href=https://hiltmon.com/tags/ title="tags section">Tags</a></li><li><a href=https://hiltmon.com/archives/ title="archives section">Archives</a></li></ul></nav><section id=content><p class=meta-data><span class=post-date>Aug 1, 2015 11:25 AM</span></p><div class=tag-group><div class=tag><span class=tag-text>| <a href=https://hiltmon.com/tags/programming>Programming</a></span></div><div class=tag><span class=tag-text>| <a href=https://hiltmon.com/tags/development>Development</a></span></div><div class=tag><span class=tag-text>| <a href=https://hiltmon.com/tags/c++>C++</a></span></div></div><h1 class=post-title>Simple C++: From Makefiles to Xcode Builds</h1><div class=post-body><p>This post will present a step-by-step process to convert C++/C++11 Makefile-based projects to Xcode build tools. I use it all the time to set up, convert, build and debug Unix/Linux executables that I develop on my Macintosh.</p><h2 id=context-and-benefits>Context and Benefits</h2><p>I write a lot of concurrent, complex, real-time C++11 code these days using my Macintosh. I prefer the look, feel, tools and services that the Macintosh and its ecosystem provides.</p><p>But the applications I build all run on Linux CentOS 6.6 Servers.</p><p>I could do this development on a Linux desktop, as a lot of people do. The tools exist and the Linux desktop sure is maturing. But, in my opinion, the OS X tools, third party productivity products, robustness, ecosystem and my habits make me far more productive on OS X. I can leverage Xcode and its amazing compilers, debuggers and IDE tools to help me build better C++11 products quicker, and then deploy using <code>git</code> and <code>make</code> to Linux. Since I use only clean C++11 and open source dependencies, all available via <a href=https://hiltmon.com/blog/2013/09/29/homebrew-happiness/>HomeBrew</a>, this model works great.</p><p><strong>Xcode provides an amazing set of tools over and above the code editor.</strong> The integrated <code>clang</code> compiler detects far more potential issues than others. The integrated <code>llvm</code> debugger and inspectors make it easy to view the content of objects at breakpoints. The thread, memory and networking panels show exactly what the program is doing and Instruments is pure wizardry. There is no reason not to take advantage of all of these robust and easy to use technologies when developing.</p><h2 id=an-example-c-makefile-with-dependencies>An Example C++ Makefile with Dependencies</h2><p>Lets start with a <em>real</em> Makefile I use for a semi-complex product with many dependencies. Its a long Makefile, but I&rsquo;ll go though the highlights below.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-make data-lang=make><span style=display:flex><span><span style=color:#177500>#
</span></span></span><span style=display:flex><span><span style=color:#177500>#  Makefile
</span></span></span><span style=display:flex><span><span style=color:#177500>#  CoralSeaServer
</span></span></span><span style=display:flex><span><span style=color:#177500>#
</span></span></span><span style=display:flex><span><span style=color:#177500>#  Created by Hilton Lipschitz on 2014-10-20.
</span></span></span><span style=display:flex><span><span style=color:#177500>#  Copyright (c) 2014 Maritime Capital LP. All rights reserved.
</span></span></span><span style=display:flex><span><span style=color:#177500>#
</span></span></span><span style=display:flex><span><span style=color:#177500></span>
</span></span><span style=display:flex><span><span style=color:#177500># HIL: No spaces or comments after otherwise it captures them!
</span></span></span><span style=display:flex><span><span style=color:#177500># Determine the platform
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#000>UNAME_S</span> <span style=color:#000>:=</span> <span style=color:#a90d91>$(</span>shell uname -s<span style=color:#a90d91>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>ifeq</span> <span style=color:#000>(</span><span style=color:#a90d91>$(</span><span style=color:#000>UNAME_S</span><span style=color:#a90d91>)</span><span style=color:#000>,Darwin)</span>
</span></span><span style=display:flex><span>	<span style=color:#000>CC</span> <span style=color:#000>:=</span> clang++ -arch x86_64
</span></span><span style=display:flex><span><span style=color:#000>else</span>
</span></span><span style=display:flex><span>	<span style=color:#000>CC</span> <span style=color:#000>:=</span> g++
</span></span><span style=display:flex><span><span style=color:#000>endif</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>SRCDIR</span> <span style=color:#000>:=</span> src
</span></span><span style=display:flex><span><span style=color:#000>LIBDIR</span> <span style=color:#000>:=</span> lib
</span></span><span style=display:flex><span><span style=color:#000>BUILDDIR</span> <span style=color:#000>:=</span> build
</span></span><span style=display:flex><span><span style=color:#000>TARGETDIR</span> <span style=color:#000>:=</span> bin
</span></span><span style=display:flex><span><span style=color:#000>INSTALLBINDIR</span> <span style=color:#000>:=</span> /usr/local/bin
</span></span><span style=display:flex><span><span style=color:#000>TARGET</span> <span style=color:#000>:=</span> bin/CoralSeaServer
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500># Normal CPP files
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#000>SRCEXT</span> <span style=color:#000>:=</span> cpp
</span></span><span style=display:flex><span><span style=color:#000>SOURCES</span> <span style=color:#000>:=</span> <span style=color:#a90d91>$(</span>shell find <span style=color:#a90d91>$(</span>SRCDIR<span style=color:#a90d91>)</span> -type f -name *.<span style=color:#a90d91>$(</span>SRCEXT<span style=color:#a90d91>))</span>
</span></span><span style=display:flex><span><span style=color:#000>OBJECTS</span> <span style=color:#000>:=</span> <span style=color:#a90d91>$(</span>patsubst <span style=color:#a90d91>$(</span>SRCDIR<span style=color:#a90d91>)</span>/%,<span style=color:#a90d91>$(</span>BUILDDIR<span style=color:#a90d91>)</span>/%,<span style=color:#a90d91>$(</span>SOURCES:.<span style=color:#a90d91>$(</span>SRCEXT<span style=color:#a90d91>)</span><span style=color:#000>=</span>.o<span style=color:#a90d91>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500># Protobuf CC files
</span></span></span><span style=display:flex><span><span style=color:#177500></span><span style=color:#000>SRCEXT2</span> <span style=color:#000>:=</span> cc
</span></span><span style=display:flex><span><span style=color:#000>SOURCES2</span> <span style=color:#000>:=</span> <span style=color:#a90d91>$(</span>shell find <span style=color:#a90d91>$(</span>SRCDIR<span style=color:#a90d91>)</span>/proto -type f -name *.<span style=color:#a90d91>$(</span>SRCEXT2<span style=color:#a90d91>))</span>
</span></span><span style=display:flex><span><span style=color:#000>OBJECTS2</span> <span style=color:#000>:=</span> <span style=color:#a90d91>$(</span>patsubst <span style=color:#a90d91>$(</span>SRCDIR<span style=color:#a90d91>)</span>/%,<span style=color:#a90d91>$(</span>BUILDDIR<span style=color:#a90d91>)</span>/%,<span style=color:#a90d91>$(</span>SOURCES2:.<span style=color:#a90d91>$(</span>SRCEXT2<span style=color:#a90d91>)</span><span style=color:#000>=</span>.o<span style=color:#a90d91>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>CFLAGS</span> <span style=color:#000>:=</span> -c
</span></span><span style=display:flex><span><span style=color:#000>ifeq</span> <span style=color:#000>(</span><span style=color:#a90d91>$(</span><span style=color:#000>UNAME_S</span><span style=color:#a90d91>)</span><span style=color:#000>,Linux)</span>
</span></span><span style=display:flex><span>	<span style=color:#000>CFLAGS</span> <span style=color:#000>+=</span> -std<span style=color:#000>=</span>gnu++11 -O2 <span style=color:#177500># -fPIC</span>
</span></span><span style=display:flex><span><span style=color:#000>else</span>
</span></span><span style=display:flex><span>	<span style=color:#000>CFLAGS</span> <span style=color:#000>+=</span> -std<span style=color:#000>=</span>c++11 -stdlib<span style=color:#000>=</span>libc++ -O2
</span></span><span style=display:flex><span><span style=color:#000>endif</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>LIB</span> <span style=color:#000>:=</span> -L /usr/local/lib -lcorinth -lprotobuf -lzmq
</span></span><span style=display:flex><span><span style=color:#000>INC</span> <span style=color:#000>:=</span> -I include -I include/proto -I /usr/local/include
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>$(TARGET)</span><span style=color:#000>:</span> <span style=color:#a90d91>$(</span><span style=color:#000>OBJECTS</span><span style=color:#a90d91>)</span> <span style=color:#a90d91>$(</span><span style=color:#000>OBJECTS</span>2<span style=color:#a90d91>)</span>
</span></span><span style=display:flex><span>	@mkdir -p <span style=color:#a90d91>$(</span>TARGETDIR<span style=color:#a90d91>)</span>
</span></span><span style=display:flex><span>	@echo <span style=color:#c41a16>&#34; Linking...&#34;</span>
</span></span><span style=display:flex><span>	@echo <span style=color:#c41a16>&#34; </span><span style=color:#a90d91>$(</span>CC<span style=color:#a90d91>)</span><span style=color:#c41a16> </span>$<span style=color:#c41a16>^ -o </span><span style=color:#a90d91>$(</span>TARGET<span style=color:#a90d91>)</span><span style=color:#c41a16> </span><span style=color:#a90d91>$(</span>LIB<span style=color:#a90d91>)</span><span style=color:#c41a16>&#34;</span>; <span style=color:#a90d91>$(</span>CC<span style=color:#a90d91>)</span> $^ -o <span style=color:#a90d91>$(</span>TARGET<span style=color:#a90d91>)</span> <span style=color:#a90d91>$(</span>LIB<span style=color:#a90d91>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>$(BUILDDIR)/%.o</span><span style=color:#000>:</span> <span style=color:#a90d91>$(</span><span style=color:#000>SRCDIR</span><span style=color:#a90d91>)</span>/%.<span style=color:#a90d91>$(</span><span style=color:#000>SRCEXT</span><span style=color:#a90d91>)</span>
</span></span><span style=display:flex><span>	@mkdir -p <span style=color:#a90d91>$(</span>BUILDDIR<span style=color:#a90d91>)</span>
</span></span><span style=display:flex><span>	@echo <span style=color:#c41a16>&#34; </span><span style=color:#a90d91>$(</span>CC<span style=color:#a90d91>)</span><span style=color:#c41a16> </span><span style=color:#a90d91>$(</span>CFLAGS<span style=color:#a90d91>)</span><span style=color:#c41a16> </span><span style=color:#a90d91>$(</span>INC<span style=color:#a90d91>)</span><span style=color:#c41a16> -c -o </span><span style=color:#000>$@</span><span style=color:#c41a16> </span>$<span style=color:#c41a16>&lt;&#34;</span>; <span style=color:#a90d91>$(</span>CC<span style=color:#a90d91>)</span> <span style=color:#a90d91>$(</span>CFLAGS<span style=color:#a90d91>)</span> <span style=color:#a90d91>$(</span>INC<span style=color:#a90d91>)</span> -c -o <span style=color:#000>$@</span> $&lt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>$(BUILDDIR)/proto/%.o</span><span style=color:#000>:</span> <span style=color:#a90d91>$(</span><span style=color:#000>SRCDIR</span><span style=color:#a90d91>)</span>/<span style=color:#000>proto</span>/%.<span style=color:#a90d91>$(</span><span style=color:#000>SRCEXT</span>2<span style=color:#a90d91>)</span>
</span></span><span style=display:flex><span>	@mkdir -p <span style=color:#a90d91>$(</span>BUILDDIR<span style=color:#a90d91>)</span>
</span></span><span style=display:flex><span>	@mkdir -p <span style=color:#a90d91>$(</span>BUILDDIR<span style=color:#a90d91>)</span>/proto
</span></span><span style=display:flex><span>	@echo <span style=color:#c41a16>&#34; </span><span style=color:#a90d91>$(</span>CC<span style=color:#a90d91>)</span><span style=color:#c41a16> </span><span style=color:#a90d91>$(</span>CFLAGS<span style=color:#a90d91>)</span><span style=color:#c41a16> </span><span style=color:#a90d91>$(</span>INC<span style=color:#a90d91>)</span><span style=color:#c41a16> -c -o </span><span style=color:#000>$@</span><span style=color:#c41a16> </span>$<span style=color:#c41a16>&lt;&#34;</span>; <span style=color:#a90d91>$(</span>CC<span style=color:#a90d91>)</span> <span style=color:#a90d91>$(</span>CFLAGS<span style=color:#a90d91>)</span> <span style=color:#a90d91>$(</span>INC<span style=color:#a90d91>)</span> -c -o <span style=color:#000>$@</span> $&lt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>clean</span><span style=color:#000>:</span>
</span></span><span style=display:flex><span>	@echo <span style=color:#c41a16>&#34; Cleaning...&#34;</span>;
</span></span><span style=display:flex><span>	@echo <span style=color:#c41a16>&#34; </span><span style=color:#a90d91>$(</span>RM<span style=color:#a90d91>)</span><span style=color:#c41a16> -r </span><span style=color:#a90d91>$(</span>BUILDDIR<span style=color:#a90d91>)</span><span style=color:#c41a16> </span><span style=color:#a90d91>$(</span>TARGET<span style=color:#a90d91>)</span><span style=color:#c41a16>&#34;</span>; <span style=color:#a90d91>$(</span>RM<span style=color:#a90d91>)</span> -r <span style=color:#a90d91>$(</span>BUILDDIR<span style=color:#a90d91>)</span> <span style=color:#a90d91>$(</span>TARGET<span style=color:#a90d91>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>install</span><span style=color:#000>:</span>
</span></span><span style=display:flex><span>	@echo <span style=color:#c41a16>&#34; Installing...&#34;</span>;
</span></span><span style=display:flex><span>	@echo <span style=color:#c41a16>&#34; cp </span><span style=color:#a90d91>$(</span>TARGET<span style=color:#a90d91>)</span><span style=color:#c41a16> </span><span style=color:#a90d91>$(</span>INSTALLBINDIR<span style=color:#a90d91>)</span><span style=color:#c41a16>&#34;</span>; cp <span style=color:#a90d91>$(</span>TARGET<span style=color:#a90d91>)</span> <span style=color:#a90d91>$(</span>INSTALLBINDIR<span style=color:#a90d91>)</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span><span style=color:#000>distclean</span><span style=color:#000>:</span>
</span></span><span style=display:flex><span>	@echo <span style=color:#c41a16>&#34; Un-Installing...&#34;</span>;
</span></span><span style=display:flex><span>	@echo <span style=color:#c41a16>&#34; rm /usr/local/bin/CoralSeaServer&#34;</span>; rm /usr/local/bin/CoralSeaServer
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>.PHONY</span><span style=color:#000>:</span> <span style=color:#000>clean</span>
</span></span></code></pre></div><p>Since this is a multi-platform Makefile, I determine the platform on line <strong>11</strong>. Lines <strong>13</strong> to <strong>17</strong> then select the compiler, <code>clang</code> for OS X and <code>g++</code> for Linux. Lines <strong>37</strong> to <strong>41</strong> set the platform specific compiler flags. Everything else is the same for all platforms.</p><p>Also, note line <strong>43</strong>, this product has three dependencies, libraries called <code>corinth</code> (my common code), <code>protobuf</code> (Google&rsquo;s protocol buffers) and <code>zmq</code> (ZeroMQ). These are installed in OS X using HomeBrew and on Linux using <code>yum</code> or the standard source distributions. All third party libraries on my OS X development box and in CentOS are in <code>/usr/local</code>.</p><p>To build this product on any supported platform, I just type the command:</p><pre tabindex=0><code>make clean; make -j 8
</code></pre><p>To install the product:</p><pre tabindex=0><code>sudo make install
</code></pre><p><span class=light>Note: On OS X I do not use <code>sudo</code> for installs.</span></p><h2 id=building-the-xcode-project>Building the Xcode Project</h2><p>We will go through several steps to build the Xcode project:</p><ul><li>Create the Xcode Project file (and then move it)</li><li>Add existing project files to the project</li><li>Remove unnecessary Target Memberships</li><li>Add <code>/usr/local/..</code> to searches</li><li>Select the libraries to link in (and create a <code>lib</code> group)</li><li>Live long and prosper</li></ul><h3 id=creating-the-xcode-project>Creating the Xcode Project</h3><p>Launch Xcode and select <strong>Create a new Xcode project</strong>.</p><figure><img src=images/xbuild-001.png width=602 height=353></figure><p>Choose <strong>Command Line Tool</strong> under <strong>OS X</strong> / <strong>Application</strong>. Click <strong>Next</strong>.</p><figure><img src=images/xbuild-002.png width=548 height=323></figure><p>Type in the Project Name (I use the name of the executable) and make sure that you choose a <code>C++</code> project. Click <strong>Next</strong>.</p><figure><img src=images/xbuild-003.png width=548 height=323></figure><p>Save the new project file in the root of the project folder (the same place the Makefile is). Click <strong>Create</strong>.</p><figure><img src=images/xbuild-004.png width=572 height=387></figure><p>The basic project should look like this (no source files have been added yet).</p><figure><img src=images/xbuild-005.png width=720 height=450></figure><p>Right-click on project (in this case CoralSeaServer) in the left pane and choose <strong>Show in Finder</strong></p><figure><img src=images/xbuild-006.png width=578 height=328></figure><p>Unfortunately, Xcode has created a new folder <em>inside</em> the project folder and placed the <code>.xcodeproj</code> file inside that. We need it at the same level as the Makefile. It has also created its own code folder and a new <code>main.cpp</code> which we no longer need. Here is how to fix it (<strong>the project file trick</strong>):</p><ul><li><strong>Quit Xcode</strong>, we&rsquo;re going to move things around in the Finder.</li><li>In <strong>Finder</strong>, drag and drop the <code>.xcodeproj</code> up a folder level to be in the same place as the Makefile.</li></ul><figure><img src=images/xbuild-007.png width=578 height=328></figure><ul><li>Then, delete the project folder created by Xcode</li></ul><figure><img src=images/xbuild-008.png width=578 height=328></figure><p>Resulting in a clean file system.</p><figure><img src=images/xbuild-009.png width=578 height=328></figure><figure class=image-right><img src=images/xbuild-010.png width=222 height=113></figure><p>Double-click the <code>.xcodeproj</code> file to launch and open the project in Xcode. You will see the <code>main.cpp</code> is now in red, indicating that it does not exist. This is what we expect because we deleted Xcode&rsquo;s created <code>main.cpp</code> in Finder. Right-click the group above the missing <code>main.cpp</code> and choose <strong>Delete</strong>. Your left pane should look something like the one on the right.</p><h3 id=add-existing-files-to-the-project>Add existing files to the Project</h3><p>We now need to add the existing code files to the Xcode project so that it can compile and index them. Right-click on the project in the top-left and select <strong>Add files to &ldquo;&mldr;&rdquo;</strong>.</p><figure><img src=images/xbuild-011.png width=720 height=450></figure><p>Select all files <em>except</em> the <code>bin</code> and <code>build</code> folders (if they exist). Make sure <strong>Create groups</strong> is selected and <strong>Add to targets</strong> refers to your new project. Click <strong>Add</strong>.</p><p><span class=light>For more information on the folders and files I use, see <a href=https://hiltmon.com/blog/2013/07/03/a-simple-c-plus-plus-project-structure/>A Simple C++ Project Structure</a>.</span></p><figure><img src=images/xbuild-012.png width=720 height=450></figure><p>Xcode will create groups for the folders in the project.</p><figure><img src=images/xbuild-013.png width=720 height=450></figure><h3 id=remove-any-unnecessary-target-memberships>Remove any unnecessary Target Memberships</h3><p>By default, Xcode tries to compile every file (except headers) that you add. Since Makefiles and Markdown files cannot be compiled, you will get errors when you first try to build the application. This happens because we added all files to the target when importing above.</p><p>Select the Makefile and <em>un</em>check <strong>Target Membership</strong>. If this is not shown, click the top-right toolbar item to show it.</p><figure><img src=images/xbuild-014.png width=720 height=450></figure><p>Repeat the <em>un</em>check for any other non-compilable files. In my case, that includes the <code>README.markdown</code> file. <strong>Do not remove any source-code files from the target or the project will not build.</strong></p><h3 id=add-usrlocal-to-searches>Add <code>/usr/local/...</code> to searches</h3><p>Since this C++11 project uses shared libraries, we need to tell the compiler where they are.</p><p>Select the Project in the top-left, and then the target. Then scroll down until you see <strong>Search Paths</strong>.</p><figure><img src=images/xbuild-015.png width=720 height=450></figure><p>Double-click the column <em>to the right</em> of <strong>Header Search Paths</strong>. It brings up a panel of search paths.</p><figure><img src=images/xbuild-016.png width=408 height=196></figure><p>Click the <code>+</code> at the bottom to add a new search path and type in <code>/usr/local/include</code>. This tells the compiler to look for headers in the public tree.</p><figure><img src=images/xbuild-017.png width=408 height=196></figure><p>Double-click the column <em>to the right</em> of <strong>Library Search Paths</strong>. It brings up a panel of search paths. Add <code>/usr/local/lib</code> to tell the compiler where to find the shared libraries.</p><figure><img src=images/xbuild-018.png width=408 height=196></figure><h3 id=choose-the-libraries-to-be-linked>Choose the Libraries to be linked</h3><p>Now we need to add the libraries that are included in Line <strong>43</strong> of the Makefile to the compilation.</p><pre tabindex=0><code>LIB := -L /usr/local/lib -lcorinth -lprotobuf -lzmq
</code></pre><p>Click <strong>Build Phases</strong> and then expand <strong>Link Binary With Libraries</strong>.</p><figure><img src=images/xbuild-019.png width=720 height=450></figure><p>There are 2 ways to add libraries, drag and drop from finder or manual add.</p><h4 id=either-drag-and-drop-from-finder>EITHER Drag and Drop from Finder</h4><p>Open a Finder window and press <code>⌘⇧G</code> (Command-Shift-G) or select <strong>Go</strong> / <strong>Go to Folder&mldr;</strong> from the menu. Type in <code>/usr/local/lib/</code> to select the public libraries folder.</p><figure><img src=images/xbuild-020.png width=720 height=450></figure><p>Drag and drop the libraries you need into the space called <strong>Add frameworks and libraries here</strong>.</p><p><strong>Tip</strong>: Libraries in UNIX are named <code>libxxx.dylib</code> where <code>xxx</code> is the same name as the <code>-l</code> in the makefile. So, in my makefile I have a <code>-lzmq</code>, then the library to drag over will be named <code>libzmq.dylib</code>. There may be other names, extensions and versions, do <em>not</em> drag these over. Only drag over the plain one. Xcode will add the correct and latest version to your project.</p><figure><img src=images/xbuild-021.png width=720 height=450></figure><p>Repeat for all the libraries in the Makefile.</p><h4 id=or-manually-add-libraries>OR Manually Add Libraries</h4><p>Click the <code>+</code> below <strong>Add frameworks and libraries here</strong>. Choose <strong>Add Other&mldr;</strong>.</p><figure><img src=images/xbuild-022.png width=300 height=345></figure><p>This brings up a standard OS X Open Sheet. Here&rsquo;s the trick: press <code>⌘⇧G</code> (Command-Shift-G) to access the <em>hidden</em> Go to Folder window. Type in <code>/usr/local/lib/</code> and click <strong>Open</strong>.</p><figure><img src=images/xbuild-023.png width=528 height=342></figure><p>Select the library file you want to add. Since I am adding the file for <code>-lzmq</code>, I add <code>libzmq.dylib</code>. Click <strong>Open</strong>.</p><p>Repeat for all the libraries in the Makefile.</p><h3 id=create-a-lib-group>Create a lib group</h3><p>After adding all the libraries, your list of libraries to link should match the Makefile.</p><figure><img src=images/xbuild-025.png width=720 height=450></figure><p>Select all the <code>lib</code> files in the left-hand pane, then right-click and choose <strong>New Group from Selection</strong>. Type <code>lib</code> to create a nice lib group and drag it down the project. <span class=light>I do this to keep the left-hand pane clean.</span></p><figure><img src=images/xbuild-026.png width=720 height=450></figure><h3 id=build-and-run>Build and Run</h3><p>We have created an Xcode project, added the source files, removed unnecessary target memberships, added search paths and link libraries, so we&rsquo;re ready to build and run.</p><p>Hit <code>⌘B</code> or click the Xcode run arrow.</p><p>The project should compile and run.</p><h3 id=what-if-it-does-not-compile-and-run>What if it does not Compile and Run</h3><p>Check the following:</p><ul><li>You added all the sources needed</li><li>You typed in the search paths properly</li><li>You added all the dependent libraries</li><li>Most Makefiles do not include all the project include files and rely on the programmer to <em>know</em> where each header is. The programmer then has to add paths to internal includes. Xcode (and good Makefiles) do not need this. If you see an error on a <code>#include "this/that.h"</code>, replace it with <code>#include "that.h"</code> and fix the Makefile (see re-testing the Makefile below on how).</li><li>Read the <code>clang</code> error (not warning) messages, they will tell you what went wrong and what needs to change.</li></ul><h2 id=re-testing-the-makefile>Re-testing the Makefile</h2><p>The project is now building in Xcode and you gain all the benefits of the Xcode ecosystem. But it is worth checking that the Makefile version still works, especially if you have made code changes.</p><p>Open a terminal, <code>cd</code> to the project folder and:</p><pre tabindex=0><code>make clean; make -j 8
</code></pre><p>If all is well, the project will compile as well.</p><p>If it does not compile, chances are you changed <code>#include</code> paths. Add the missing include paths as per my line <strong>44</strong>:</p><pre tabindex=0><code>INC := -I include -I include/proto -I /usr/local/include
</code></pre><br><h2 id=live-long-and-prosper>Live Long and Prosper</h2><p>You now have a C++ project that compiles both ways, from a Makefile and via the Xcode build system and get the best of both worlds:</p><ul><li>The Makefile version works cross platform and can be used for production deploys.</li><li>The Xcode build system gives you access to IDE error checking, inspection, monitors and Instruments.</li></ul><p>For more <strong>C++</strong> articles, see my <a href=https://hiltmon.com/blog/categories/c-plus-plus/>C++ Category</a>.</p><p>Enjoy</p><p><em>Follow the author as <a href=https://twitter.com/hiltmon>@hiltmon</a> on Twitter.</em></p></div><p class=post-mark><span class="fas fa-envelope"></span>
<span>Posted By Hilton Lipschitz</span>
&#183;
<span class="fas fa-clock"></span>
<span>Aug 1, 2015 11:25 AM</span></p><div class=pagination><ul><li class=post-previous><a href=https://hiltmon.com/blog/2015/08/05/in-the-press-this-weeks-hedge-fund-alert/>&larr; In the Press: This Week's Hedge Fund Alert</a></li><li class=post-center>&nbsp;</li><li class=post-next><a href=https://hiltmon.com/blog/2015/07/05/kindred-family/>Kindred-Family &rarr;</a></li></ul></div></section><aside id=sidebar><script async type=text/javascript src="//cdn.carbonads.com/carbon.js?serve=CKYI52JE&placement=hiltmoncom" id=_carbonads_js></script><section><div id=carbonads></div>&nbsp;</section><section><h1>The Hiltmon Dot Com</h1><p><strong>Hilton Lipschitz</strong> (<a href=https://twitter.com/hiltmon>@hiltmon</a>) an independent software consultant, architect, designer and developer at <a href=https://noverse.com>Noverse LLC</a> (his own small business).</p><p>For the past 22 years he has specialized in the architecture, design, development, operations and trading of bespoke comprehensive front-to-back, multi-asset, <em>automated and algorithmic</em> trading, portfolio management and asset management systems to enable and grow three asset managers.</p><p><a href=https://twitter.com/hiltmon>Twitter</a> &#183;
<a href=https://github.com/hiltmon>Github</a> &#183;
<a href=https://www.linkedin.com/in/hiltmon/>LinkedIn</a> &#183;
<a href=https://hiltmon.com/index.xml>RSS</a></p></section><section><h1>Recent Posts</h1><ul><li><a class=sidebar-link href=https://hiltmon.com/blog/2022/10/26/where-the-rights-are/>Where the Rights Are</a></li><li><a class=sidebar-link href=https://hiltmon.com/blog/2022/10/20/innocuous-birthday-career-advice/>Innocuous Birthday Career Advice</a></li><li><a class=sidebar-link href=https://hiltmon.com/blog/2022/10/12/go-to-where-the-puck-is-going/>Go to Where the Puck Is Going</a></li><li><a class=sidebar-link href=https://hiltmon.com/blog/2022/10/04/hiltmonism-discoverability-is-deserved/>Discoverability Is Deserved</a></li><li><a class=sidebar-link href=https://hiltmon.com/blog/2022/09/13/what-did-i-create-as-an-asset-manager-cto/>What Did I Create as an Asset Manager CTO</a></li><li><a class=sidebar-link href=https://hiltmon.com/blog/2022/08/22/optimizing-short-form-writing-for-developers/>Optimizing Short Form Writing for Developers</a></li><li><a class=sidebar-link href=https://hiltmon.com/blog/2022/08/10/code-review-is-not-all-about-the-code/>Code Review is not all about the Code</a></li><li><a class=sidebar-link href=https://hiltmon.com/blog/2020/06/07/working-from-home-88-days-later/>Working from Home ... 88 Days Later</a></li><li><a class=sidebar-link href=https://hiltmon.com/blog/2020/03/14/working-from-home-dot-dot-dot-here-we-go/>Working from Home ... here we go!</a></li><li><a class=sidebar-link href=https://hiltmon.com/blog/2019/12/31/the-theater-was-empty/>The Theater was Empty</a></li></ul><section></aside><footer id=footer><p>Copyright &copy; 2022 Hilton Lipschitz</p></footer></div></body></html>